<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Maintenance Mode</title>
        <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
        <style>
            /* Snowflake Effect */
            #snow-container {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                pointer-events: none;
                z-index: 1000;
                overflow: hidden;
            }

            .snowflake {
                position: absolute;
                top: -10px;
                font-size: 1.5rem;
                color: #3b82f6; /* Brighter blue color for snowflakes */
                text-shadow: 0 0 8px rgba(59, 130, 246, 0.7); /* Stronger glow effect */
                user-select: none;
                animation: snowfall linear infinite;
                will-change: transform; /* Improve performance */
            }

            @keyframes snowfall {
                0% {
                    transform: translateX(0) translateY(0) rotate(0deg);
                }
                100% {
                    transform: translateX(-30px) translateY(100vh) rotate(360deg);
                }
            }

            /* Control snowflake speed and size */
            .snowflake {
                animation-duration: 10s; /* Faster animation */
                opacity: 0.9; /* More visible */
            }

            /* Increase variability in size and speed */
            .snowflake:nth-child(odd) {
                animation-duration: 12s;
                opacity: 0.8;
            }

            .snowflake:nth-child(even) {
                animation-duration: 15s;
                opacity: 1;
            }

            /* Ensure compatibility with older browsers */
            @supports (-ms-ime-align: auto) {
                /* Edge specific fixes */
                .snowflake {
                    animation: none; /* Disable animation in Edge if it causes issues */
                }
            }

            @supports (-moz-appearance: none) {
                /* Firefox specific fixes */
                .snowflake {
                    will-change: transform; /* Improve performance in Firefox */
                }
            }

            /* iOS Safari fixes */
            @supports (-webkit-overflow-scrolling: touch) {
                .snowflake {
                    will-change: transform; /* Improve performance in iOS Safari */
                }
                #snow-container {
                    -webkit-transform: translateZ(0); /* Force hardware acceleration */
                }
            }

            /* Responsive adjustments */
            @media (max-width: 768px) {
                .snowflake {
                    font-size: 1.2rem; /* Smaller snowflakes on mobile */
                }
            }

            @media (max-width: 480px) {
                .snowflake {
                    font-size: 1rem; /* Even smaller snowflakes on small mobile */
                }
            }

            /* Reduce animation on devices that prefer reduced motion */
            @media (prefers-reduced-motion: reduce) {
                .snowflake {
                    animation-duration: 30s !important; /* Much slower animation */
                }
                #snow-container {
                    opacity: 0.5; /* Reduce visibility */
                }
            }

            /* Morph item styling */
            .morph-item {
                background: rgba(255, 255, 255, 0.9);
                backdrop-filter: blur(10px);
                border-radius: 20px;
                border: 1px solid rgba(0, 0, 0, 0.1);
                box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            }

            .morph-button {
                transition: all 0.3s ease;
                touch-action: manipulation;
            }

            .morph-button:hover {
                transform: translateY(-2px);
            }

            .morph-button:active {
                transform: scale(0.95);
            }
        </style>
    </head>
    <body class="bg-white text-gray-900 flex items-center justify-center min-h-screen w-full overflow-hidden fixed inset-0 transition-colors duration-300 p-4">
        <div class="text-center morph-item px-2 sm:px-4 lg:px-6 max-w-sm sm:max-w-md w-full">
            <div class="mx-auto mb-4 relative w-32 h-32 sm:w-48 sm:h-48 md:w-56 md:h-56">
                <img
                    id="maintenanceGif"
                    src="https://media.giphy.com/media/3oEjI6SIIHBdRxXI40/giphy.gif"
                    alt="Maintenance"
                    class="object-contain w-full h-full"
                />
            </div>
            
            <h1 id="maintenanceTitle" class="text-xl sm:text-2xl md:text-3xl font-bold mb-2">
                ðŸ”§ Under Maintenance
            </h1>
            
            <p id="maintenanceMessage" class="text-xs sm:text-sm md:text-base text-gray-600 mb-4 leading-relaxed">
                We're currently performing scheduled maintenance to improve our services. Please check back soon!
            </p>
            
            <div class="flex flex-col sm:flex-row justify-center space-y-2 sm:space-y-0 sm:space-x-4">
                <button
                    onclick="window.location.reload()"
                    class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-700 transition morph-button touch-manipulation active:scale-95 text-sm sm:text-base"
                >
                    Retry
                </button>
                
                <button
                    onclick="window.location.href='/'"
                    id="homeButton"
                    class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-700 transition morph-button touch-manipulation active:scale-95 text-sm sm:text-base inline-block text-center"
                >
                    Go Home
                </button>
            </div>
        </div>
        
        <div id="snow-container" class="pointer-events-none"></div>
        
        <script>
            function createSparkle() {
                const snowContainer = document.getElementById("snow-container");
                if (!snowContainer) return;
                
                const sparkle = document.createElement("div");
                sparkle.classList.add("snowflake");
                sparkle.textContent = "âœ¨";
                
                const left = Math.floor(Math.random() * 100);
                const duration = 5 + Math.floor(Math.random() * 10);
                const scale = 0.5 + Math.floor(Math.random() * 15) / 10;
                
                sparkle.style.left = `${left}%`;
                sparkle.style.animationDuration = `${duration}s`;
                sparkle.style.transform = `scale(${scale})`;
                
                snowContainer.appendChild(sparkle);
                
                sparkle.addEventListener("animationend", () => {
                    sparkle.remove();
                });
            }

            // Start sparkle animation
            const timeoutId = setTimeout(() => {
                const sparkleInterval = setInterval(createSparkle, 300);
                
                // Cleanup function would go here in React
                // For vanilla JS, we'll let it run
            }, 1000);

            // Load maintenance settings from API
            fetch('/api/settings')
                .then(response => response.json())
                .then(data => {
                    if (data.maintenance) {
                        const maintenance = data.maintenance;
                        
                        if (maintenance.title) {
                            document.getElementById('maintenanceTitle').textContent = maintenance.title;
                        }
                        
                        if (maintenance.message) {
                            document.getElementById('maintenanceMessage').textContent = maintenance.message;
                        }
                        
                        if (maintenance.gifUrl) {
                            document.getElementById('maintenanceGif').src = maintenance.gifUrl;
                        }
                        
                        if (!maintenance.showHomeLink) {
                            document.getElementById('homeButton').style.display = 'none';
                        }
                    }
                })
                .catch(error => {
                    console.log('Using default maintenance settings');
                });
        </script>
    </body>
</html>
